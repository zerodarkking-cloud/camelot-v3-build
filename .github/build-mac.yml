name: Build macOS App

on:
  push:
    branches: [ "main", "master" ] # –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—É—à–µ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É
  workflow_dispatch: # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–±–æ—Ä–∫—É –≤—Ä—É—á–Ω—É—é –∫–Ω–æ–ø–∫–æ–π

jobs:
  build:
    runs-on: macos-latest # üî• –ú—ã –≥–æ–≤–æ—Ä–∏–º GitHub –≤—ã–¥–µ–ª–∏—Ç—å –Ω–∞–º —Å–µ—Ä–≤–µ—Ä –Ω–∞ macOS!

    steps:
      - name: –°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥
        uses: actions/checkout@v4

      - name: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # –í–µ—Ä—Å–∏—è Node.js

      - name: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        run: npm install

      - name: –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è Mac
        run: npm run pack:mac
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥–æ—Ç–æ–≤—ã–π .dmg —Ñ–∞–π–ª
        uses: actions/upload-artifact@v4
        with:
          name: Camelot-V3-Mac-App
          path: release/*.dmg